/*
 * @overview underscore - JavaScript's utility _ belt
 * @copyright Copyright (c) 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jashkenas/underscore/master/LICENSE
 * @version   1.8.0
 */ !function(){var a=function b(c,d,e){function f(h,i){if(!d[h]){if(!c[h]){var j="function"==typeof a&&a;if(!i&&j)return j(h,!0);if(g)return g(h,!0);var k=new Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",k}var l=d[h]={exports:{}};c[h][0].call(l.exports,function(a){var b=c[h][1][a];return f(b?b:a)},l,l.exports,b,c,d,e)}return d[h].exports}for(var g="function"==typeof a&&a,h=0;h<e.length;h++)f(e[h]);return f}({1:[function(a,b){var c=a("./utils.js"),d=a("./browser.js"),e=function(){return this instanceof e?void this.init():new e};e.prototype.init=function(){this.data={},this.dead=!1},e.prototype.event=function(a){return c.isObject(a)?(c.assert(a.event,"a.event no event"),c.assert(a.listener,"a.event no listener"),[a.event,a.listener].join(".")):a},e.prototype.add=function(a,b,c,d){c=c===!0?!0:!1,a=this.event(a);var e={func:b,one:c,ctx:d};return this.data.hasOwnProperty(a)?this.data[a].push(e):this.data[a]=[e],this},e.prototype.on=function(a,b,c){return this.add(a,b,!1,c)},e.prototype.off=function(a,b){if(!this.data.hasOwnProperty(a))return this;var d=c.reduce(this.data[a],function(a,d){return c.isNone(b)||d.func!==b?c.isNone(b)?a:(a.push(d),a):a},[]);return 0===d.length?delete this.data[a]:this.data[a]=d,this},e.prototype.one=function(a,b,c){return this.add(a,b,!0,c)},e.prototype.get=function(a,b,d,e){c.isFunction(b)&&(d=b,b={},d&&(e=d)),b||(b={}),c.assert(d),b.hasOwnProperty("listener")||(b.listener="l"+c.getUUID()),this.one({event:a,listener:b.listener},d,e),this.notify(a,b)},e.prototype.notify=function(){if(this.dead)return!1;var a=Array.prototype.slice.call(arguments,0);if(0===a.length)return this;var b=this.event(a.splice(0,1)[0]);if(!this.data.hasOwnProperty(b))return this;var e,f=[],g=[];return c.each(this.data[b],function(a){g.push(a),a.one===!1&&f.push(a)}),0===f.length?delete this.data[b]:this.data[b]=f,c.each(g,function(f){try{e=c.isNone(f.ctx)?this:f.ctx,f.func.apply(e,a)}catch(g){d.console.error(b,a,g)}},this),this},e.prototype.listeners=function(a){return c.reduce(this.data,function(b,c,d){var e=d.split(".");return 2===e.length&&e[0]===a&&b.push(e[1]),b},[])},e.prototype.clear=function(){this.dead=!0,this.data={}},b.exports=e},{"./browser.js":4,"./utils.js":29}],2:[function(a,b){var c=a("./utils.js"),d=a("./browser.js"),e=a("conf"),f={};f.random=function(a){return Math.floor(Math.random()*a)},f.safeCreateQuery=function(a){var b=c.map(a,function(a,b){return b+"="+("urls"===b?a:encodeURIComponent(a))});return b.sort(),b.join("&")},f.Keeper=function(a,b){this.init(a,b)},f.Keeper.prototype={init:function(a,b){this.urls=a,this.count=0,this.results={},this.callback=b},each:function(a){if(this.results[a.original_url]=a,this.count++,this.count===this.urls.length){var b=c.map(this.urls,function(a){return this.results[a]},this);this.callback(b)}return this}},f.ajax=function(a,b,d,e){var f=new XMLHttpRequest,g=e?"POST":"GET";if("withCredentials"in f)f.open(g,a,!0),d&&c.map(d,function(a,b){f.setRequestHeader(b,a)}),f.setRequestHeader("Accept","application/json"),f.onreadystatechange=function(){4===f.readyState&&(200===f.status?b&&b(JSON.parse(f.responseText)):b&&b({type:"error"}))};else{if("undefined"==typeof XDomainRequest)return b({type:"error"}),!1;f=new XDomainRequest,f.open(g,a),f.onload=function(){b&&b(JSON.parse(f.responseText))},f.onerror=function(){b({type:"error"})},f.onprogress=function(){}}f.send(e?e:null)},f.API=function(a){this.init(a)},f.API.prototype.init=function(a){c.isString(a)?this.key=a:c.isNone(a)||(this.key=a.key),this.key=this.key?this.key:e.EMB_API_KEY,this.protocol="https:"},f.API.prototype._buildUrl=function(a,b){if(c.isNone(this.key))return null;var d=this.protocol+"//api-cdn.embed.ly/"+a;return b=b?b:{},b.key||(b.key=this.key),d+"?"+f.safeCreateQuery(b)},f.API.prototype._data=function(a,b,e,g){if(d.console.log(a,b,e,g),c.isNone(g)&&c.isFunction(e)&&(g=e,e={}),c.isNone(g))return!1;if(c.isString(b)){e.url=b;var h=this._buildUrl(a,e);return f.ajax(h,function(a){a.url=b,g(a)}),!0}if(c.isArray(b)){if(0===b.length)return!1;var i=new f.Keeper(b,g),j=c.batch(b,10),k=function(a,b){return function(d){c.each(b,function(b,c){var e=d[c];e.original_url=b,a.each(e)})}};return c.each(j,function(b){e.urls=c.map(b,function(a){return encodeURIComponent(a)}).join(",");var d=this._buildUrl(a,e);f.ajax(d,k(i,b))},this),!0}return g({type:"error"}),!1},f.API.prototype.oembed=function(a,b,c){return this._data("1/oembed",a,b,c)},f.API.prototype.extract=function(a,b,c){return this._data("1/extract",a,b,c)},f.API.prototype.card=function(a,b,c){return this._data("1/card-details",a,b,c)},f.API.prototype.event=function(a,b){var c="api-"+f.random(10)+".embed.ly",d=this.protocol+"//"+c+"/1/e",e=d+"?"+f.safeCreateQuery(a);f.ajax(e,b)},f.Display=function(){},f.Display.prototype._buildUrl=function(a,b,d){var g={key:e.EMB_API_KEY,url:b},h=c.extend(g,c.isNone(d)?{}:d),i="://i-cdn.embed.ly/1/display"+("display"===a?"":"/"+a);return(e.EMB_HTTPS?"https":"http")+i+"?"+f.safeCreateQuery(h)},f.Display.prototype.display=function(a,b){return this._buildUrl("display",a,b)},f.Display.prototype.crop=function(a,b){return this._buildUrl("crop",a,b)},f.Display.prototype.resize=function(a,b){return this._buildUrl("resize",a,b)},f.api=function(a){return new f.API(a)},f.display=function(){return new f.Display},b.exports=f},{"./browser.js":4,"./utils.js":29,conf:"conf"}],3:[function(a,b){var c=a("./utils"),d=a("./urlparse.js"),e={disallowed:["1kd60cb"]};e.allowed=function(a){if(!a)return!0;var b=d.getDomain(a);if(!b)return!0;var f=c.fullHash(b);return-1===e.disallowed.indexOf(f)},b.exports=e},{"./urlparse.js":28,"./utils":29}],4:[function(a,b){var c=a("./utils.js"),d=a("./dom.js"),e=a("./urlparse.js"),f=a("conf"),g={};g.supports={_test:function(a){var b=["Webkit","Moz","O","ms","Khtml"],d=document.createElement("div"),e=a.charAt(0).toUpperCase()+a.substr(1),f=[a];c.each(b,function(a){f.push(a+e)});for(var g=0;g<f.length;g++)if(""===d.style[f[g]])return!0;return!1},postMessage:function(){return!!window.postMessage},boxShadow:function(){return g.supports._test("boxShadow")},borderRadius:function(){return g.supports._test("borderRadius")},touch:function(){return!!("ontouchstart"in window)},svg:function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},mediaQuery:function(){return!("undefined"==typeof window.matchMedia&&"undefined"==typeof window.msMatchMedia)},rgba:function(){var a=document.createElement("div"),b=a.style.color;try{a.style.color="rgba(1,5,13,0.44)"}catch(c){}return a.style.color!==b},cors:function(){if("undefined"==typeof XMLHttpRequest)return!1;var a=new XMLHttpRequest;return"withCredentials"in a?!0:"undefined"!=typeof XDomainRequest?!0:!1},flash:function(){if("undefined"!=typeof navigator.plugins&&0!==navigator.plugins.length)return!!navigator.plugins["Shockwave Flash"];try{return!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(a){return!1}},canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}},g.detect=function(){var a=function(a,b){b?d.addClass(document.body,a):d.addClass(document.body,"no-"+a)};a("touch",g.supports.touch()),a("boxshadow",g.supports.boxShadow()),a("borderradius",g.supports.borderRadius()),a("rgba",g.supports.rgba()),a("mediaquery",g.supports.mediaQuery())},g.console={_log:function(a,b){if((f.EMB_DEBUG||window.EMB_DEBUG)&&!c.isNone(window.console)&&window.console&&window.console[a])if(window.console[a].apply)window.console[a].apply(window.console,b);else{var d=Array.prototype.join.call(b,", ");window.console[a](d)}},log:function(){this._log("log",arguments)},error:function(){this._log("error",arguments)}},g.open=function(a,b,d,e,f,h){if(c.isNone(f)||c.isNone(h)){var i=g.window.center(d,e);f=i.top,h=i.left}var j=window.open(a,b,"scrollbars=no, resizable=1, width="+d+", height="+e+", top="+f+", left="+h);window.focus&&j.focus()},g.cookie={set:function(a,b,c,d){var e="";if(c){var f=new Date;f.setTime(f.getTime()+24*c*60*60*1e3),e="; expires="+f.toGMTString()}document.cookie=a+"="+b+e+"; path=/"+(d?"; secure":"")},get:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return null},del:function(a){g.cookie.set(a,"",-1)}},g.window={innerHeight:function(){return c.isNone(window.innerHeight)?document.documentElement.clientHeight:window.innerHeight},innerWidth:function(){return c.isNone(window.innerWidth)?document.documentElement.clientWidth:window.innerWidth},scrollY:function(){return c.isNone(window.pageYOffset)?(document.documentElement||document.body.parentNode||document.body).scrollTop:window.pageYOffset},center:function(a,b){var c=void 0!==window.screenLeft?window.screenLeft:screen.left,d=void 0!==window.screenTop?window.screenTop:screen.top,e=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,f=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,g=e/2-a/2+c,h=f/2-b/2+d;return{left:g,top:h}}},g.location={hash:function(){var a=window.location.href.split("#");return 2===a.length?a[1]:""},params:function(){return c.extend({},e.parseQuery(document.location.search),e.parseQuery(g.location.hash()))}},g.mobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},g.isIE=function(){return/msie|trident/i.test(navigator.userAgent)},g.isFirefox=function(){return/firefox/i.test(navigator.userAgent)},g.isPhantom=function(){return/phantomjs/i.test(navigator.userAgent)},g.isSafari=function(){return/safari/i.test(navigator.userAgent)&&!/chrome/i.test(navigator.userAgent)},g.language=function(){return window.navigator.userLanguage||window.navigator.language},g.animateScroll=function(a,b){var c,e,f=g.window.scrollY(),h=a-f,i=(new Date).getTime(),j=!1;b=b?b:500;var k=Math.round(h/b*10),l=function(b){return b>a};0>k&&(l=function(b){return a>b});var m=function(){clearInterval(c),g.console.log("duration",(new Date).getTime()-i),d.detachEvent("scroll",e)};c=setInterval(function(){return f+=k,l(f)?(m(),!1):(window.scrollTo(0,f),void(j=!0))},10),e=function(){j&&f!==g.window.scrollY()&&m()},d.addEvent("scroll",e)},g.isSandboxIframe=function(){if(window.parent===window)return!1;try{var a=window.frameElement;return!a.src}catch(b){return!1}return!1},b.exports=g},{"./dom.js":7,"./urlparse.js":28,"./utils.js":29,conf:"conf"}],5:[function(a,b){var c=!1,d=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,e=function(){};e.extend=function(a){function b(){!c&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;c=!0;var f=new this;c=!1;for(var g in a)f[g]="function"==typeof a[g]&&"function"==typeof e[g]&&d.test(a[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,a[g]):a[g];return b.prototype=f,b.prototype.constructor=b,b.extend=arguments.callee,b},b.exports=e},{}],6:[function(a,b){var c=a("./iframes/comms.js").one,d=a("./utils.js"),e={started:!1,instance:null};e.EVENTS=["xcomm.options.access","xcomm.media.recommend","xcomm.card.recommend","xcomm.log.event","xcomm.page.progress"],e.clear=function(){e.instance&&(e.instance.remove(),e.instance=null),e.started=!1},e.connect=function(a,b){if(!a||e.started)return!1;e.started=!0;var f=c(a,b);return e.instance=f,d.each(e.EVENTS,function(b){f.on(b,function(c){var d=b;c.listener&&(d={event:b,listener:c.listener}),a.notify(d,c)}),a.on(b,function(a){f.send(b,a)})}),f.on("xcomm.ready",function(b){a.notify("xcomm.ready",b)}),f},b.exports=e},{"./iframes/comms.js":13,"./utils.js":29}],7:[function(a,b){var c=a("./utils.js"),d=a("conf"),e={};e.toArray=function(a){return c.map(a,function(a){return a})},e.all=function(a){var b=[];return document.querySelectorAll?e.toArray(document.querySelectorAll(a)):b},e.one=function(a,b){var c=e.all(a,b);return 0===c.length?null:c[0]},e.create=function(a,b,d,f){if(!a||!c.isString(a))return null;c.isString(b)&&c.isNone(d)&&(d=b,b={});var g;return g=f?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a),c.each(b,function(a,b){g.setAttribute(b,a)}),d&&e.text(g,d),g},e.set=function(a,b,d){if(!a||!c.isString(a))return null;c.isString(b)&&c.isNone(d)&&(d=b,b={});var f=e.one(a);return f?(c.each(b,function(a,b){f.setAttribute(b,a)}),c.isNone(d)||e.text(f,d),f):null},e.replace=function(a,b){c.assert(c.isElement(a),"replace requires an element to be replaced"),c.assert(c.isElement(b),"replace requires an element to replace with."),a.parentNode.replaceChild(b,a)},e.remove=function(a){return c.isElement(a)&&c.isElement(a.parentNode)?void a.parentNode.removeChild(a):!1},e.hide=function(a){return c.isString(a)&&(a=e.one(a)),c.isElement(a)&&(a.style.display="none"),a},e.show=function(a,b){return c.isString(a)&&(a=e.one(a)),c.isElement(a)&&(a.style.display=b?"inline-block":"block"),a},e.svg=function(a,b,c){return e.create(a,b,c,"http://www.w3.org/2000/svg")},e.children=function(a,b){return c.isElement(a)?c.reduce(a.childNodes,function(a,d){if(c.isElement(d)){if(!c.isNone(b))if(d.namespaceURI&&"http://www.w3.org/2000/svg"===d.namespaceURI){if(d.nodeName!==b)return a}else if(b.toUpperCase()!==d.nodeName)return a;a.push(d)}return a},[]):[]},e.child=function(a,b){var c=e.children(a,b);return 0!==c.length?c[0]:null},e.text=function(a,b){if(c.isString(a)&&(a=e.one(a)),!a||!c.isElement(a))return null;if(c.isNone(b))return a.innerText||a.textContent;var d=void 0===a.textContent?"innerText":"textContent";a[d]=b},e.hasClass=function(a,b){if(c.isString(a)&&(a=e.one(a)),!c.isElement(a)||!c.isString(b)||!b)return!1;var d=a.getAttribute("class");return c.isNone(d)?!1:(" "+d+" ").indexOf(" "+b+" ")>-1?!0:!1},e.addClass=function(a,b){if(c.isString(a)&&(a=e.one(a)),!c.isElement(a)||!c.isString(b)||!b)return!1;if(e.hasClass(a,b))return!1;var d=a.getAttribute("class");if(c.isNone(d))return a.setAttribute("class",b),!0;var f=d.split(" "),g=[];return c.map(f,function(a){var b=c.trim(a);""!==b&&g.push(b)}),g.push(b),a.setAttribute("class",g.join(" ")),!0},e.removeClass=function(a,b){if(c.isString(a)&&(a=e.one(a)),!c.isElement(a)||!c.isString(b)||!b)return!1;var d=a.getAttribute("class");if(c.isNone(d))return!1;var f=!1,g=c.reduce(d.split(" "),function(a,d){var e=c.trim(d);return e?e===b?(f=!0,a):(a.push(e),a):a},[]);return a.setAttribute("class",g.join(" ")),f},e.data=function(a,b,d){c.assert(a&&c.isElement(a),"dom.data needs an element."),c.assert(b&&c.isString(b),"dom.data needs an attr.");var e=c.camelCase(b,1);return c.isNone(d)?c.isNone(a.dataset)?a.getAttribute("data-"+b):c.isNone(a.dataset[e])?null:a.dataset[e]:void(c.isNone(a.dataset)?a.setAttribute("data-"+b,d):a.dataset[e]=d)},e.attrize=function(a){return a&&c.isObject(a)?c.map(a,function(a,b){return b+'="'+a+'"'}).sort().join(" "):""},e.event=function(a){var b=c.extend({},a||window.event);return b.target||(b.target=b.srcElement||document),3===b.target.nodeType&&(b.target=b.target.parentNode),!a.metaKey&&a.ctrlKey&&(b.metaKey=b.ctrlKey),b.stop=function(){a.preventDefault?a.preventDefault():a.returnValue=!1},b.pageX||b.pageY||!b.clientX&&!b.clientY||(b.pageX=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,b.pageY=b.clientY+document.body.scrollTop+document.documentElement.scrollTop),b},e.addEvent=function(a,b,d){c.isNone(a)||(a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent?a.attachEvent("on"+b,d):a["on"+b]=d)},e.detachEvent=function(a,b,d){c.isNone(a)||(a.removeEventListener?a.removeEventListener(b,d,!1):a.detachEvent?a.detachEvent("on"+b,d):a["on"+b]=null)},e.trigger=function(a,b){c.assert(c.contains(["click"],b),"Not a valid event");var d;a.dispatchEvent?(d=document.createEvent("MouseEvents"),d.initEvent(b,!0,!0),a.dispatchEvent(d,!0)):(d=document.createEventObject(),a.fireEvent("on"+b,d))},e.rect=function(a){try{return a.getBoundingClientRect()}catch(b){}return!1},e.onResize=function(a){var b;e.addEvent(window,"resize",function(){clearTimeout(b),b=setTimeout(a,100)})},d.EMB_DEBUG===!0&&(window.dom=e),b.exports=e},{"./utils.js":29,conf:"conf"}],8:[function(a,b){var c=a("./utils.js"),d=a("./swap.js"),e=a("./dom.js"),f=a("./mutations.js"),g={timeout:null,hub:null,selectors:{cards:[{selector:".embedly-card"},{selector:".reddit-card"}],button:[".embedly-button"],slideshow:[".embedly-slideshow"]},analytics:null,_queue:[]};g.add={},g.add.cards=function(a){if(c.isString(a)){if(".embedly-card"===a)return!1;g.selectors.cards.push({selector:a})}else if(!c.isElement(a)&&c.isObject(a)){if(!a.selector&&!a.types)return!1;var b={};if(c.isArray(a.types)&&a.types.length>0&&(b.types=a.types),a.selector)b.selector=a.selector,g.selectors.cards.push(b);else{var d=g.selectors.cards.reduce(function(a,b){return".embedly-card"===b.selector?b:a},{});if(!d)return!1;d.types=b.types}}g.look()},g.add.button=function(a){c.isString(a)&&(g.selectors.button.push(a),g.look())},g.select=function(a,b){return"."===a.substr(0,1)?e.hasClass(b,a.substr(1))?!0:!1:c.contains(e.all(a),b)?!0:!1},g.each=function(a){var b,c;if("A"===a.nodeName||"BLOCKQUOTE"===a.nodeName)for(b=0;b<g.selectors.cards.length;b++)if(c=g.selectors.cards[b],g.select(c.selector,a))return a._em_opts=c,{name:"card",node:a};if("A"===a.nodeName)for(b=0;b<g.selectors.button.length;b++)if(g.select(g.selectors.button[b],a))return{name:"button",node:a};if("DIV"===a.nodeName)for(b=0;b<g.selectors.slideshow.length;b++)if(g.select(g.selectors.slideshow[b],a))return{name:"slideshow",node:a};if("IFRAME"===a.nodeName){if("embedly-embed"===a.className)return{name:"iframe",node:a};if(a.src&&/\/\/cdn\.embedly\.com\/widgets\/media\.html/.test(a.src))return{name:"iframe",node:a};if(null!==g.analytics&&g.analytics.replace){var e=d.replace(a,g.analytics);if(null!==e)return{name:"iframe",node:e}}}return null},g.release=function(){var a=g._queue;g._queue=[],a=c.reduce(a,function(a,b){return c.contains(a,b)?a:b.className&&"embd-"===b.className.substr(0,5)?a:(a.push(b),a)},[]);var b=c.reduce(a,function(a,b){var c=g.each(b);return c&&a[c.name+"s"].push(c.node),a},{cards:[],buttons:[],slideshows:[],iframes:[]});g.hub.notify("found",b)},g.queue=function(a){clearTimeout(g.timeout),g._queue.push(a),g.timeout=setTimeout(function(){g.release()},50)},g.look=function(){c.each(g.selectors.cards,function(a){c.each(e.all(a.selector),function(a){g.queue(a)})}),c.each(g.selectors.button,function(a){c.each(e.all(a),function(a){g.queue(a)})}),c.each(g.selectors.slideshow,function(a){c.each(e.all(a),function(a){g.queue(a)})}),c.each(e.all("iframe"),function(a){g.queue(a)}),g.hub&&g.hub.notify("look.done")},g.stop=function(){f.stop()},g.connect=function(a){g.hub=a,a.on("mutation.insert.a",g.queue),a.on("mutation.insert.blockquote",g.queue),a.on("mutation.insert.iframe",g.queue),f.connect(a),g.look()},b.exports=g},{"./dom.js":7,"./mutations.js":20,"./swap.js":26,"./utils.js":29}],9:[function(a,b){b.exports={cards:a("./cards.js"),button:a("./button.js"),modal:a("./modal.js"),slideshow:a("./slideshow.js"),comms:a("./comms.js"),connect:a("./base.js").connect}},{"./base.js":10,"./button.js":11,"./cards.js":12,"./comms.js":13,"./modal.js":14,"./slideshow.js":15}],10:[function(a,b){var c=a("../utils.js"),d=a("../dom.js"),e=a("../a.js"),f=a("../browser.js"),g=a("../urlparse.js"),h=a("conf"),i={};i.connect=function(a,b,h){if(!b||!c.isElement(b))return!1;var i={sid:a,elem:b},j=g.getOrigin(b.src?b.src:document.location.toString()),k=new e,l=[],m=!1,n=b.src;i.on=function(a,b,c){k.on(a,b,c)},i.one=function(a,b,c){k.one(a,b,c)},i.off=function(a,b){k.off(a,b)},i.send=function(a,b,d){if(c.isNone(b)&&(b={}),c.isString(b)&&(b={msg:b}),b.method=a,m===!1&&!d)return f.console.log("frame.queue",b),l.push(b),!1;if(i.sid&&(b.sid=i.sid),f.console.log("frame.send",b),i.__tunnel)i.__tunnel.send(b);else if(i.elem.contentWindow&&i.elem.contentWindow.postMessage){var e=JSON.stringify(b);i.elem.contentWindow.postMessage(e,null===j?"*":j)}},i.ready=function(){m||(f.console.log("frame.ready",i.name),m=!0,c.each(l,function(a){i.send(a.method,a)}))},i.resize=function(a){a.width&&i.elem.setAttribute("width",a.width),a.height&&i.elem.setAttribute("height",a.height)},i.remove=function(){d.remove(i.elem),i.__hub.clear(),i.__tunnel&&i.__tunnel.clear(),i._remove&&i._remove()},k.on("message",function(a){"resize"===a.method&&i.resize&&i.resize(a),a.event&&a.listener?k.notify({event:a.event,listener:a.listener},a):a.method&&k.notify(a.method,a)});var o=function(a,b){if(a.origin===j||null===j||"about:"===a.origin){if(!b.src&&!b.sid&&!b.listener)return!1;if(i.sid&&b.sid!==i.sid)return!1;if(b.src&&b.src!==n)return!1;f.console.log("frame.message",b),k.notify("message",b)}};return h.on("window.message",o),i._remove=function(){h.off("window.message",o)},i.__hub=k,i},i.rendering=function(a){return"1"===d.data(a,"rendering")?!0:(d.data(a,"rendering","1"),!1)},i.create=function(a,b,e,f,g){var j=c.getUUID();e.sid=j;var k=c.extend({},f);e.sandbox===!1&&(k.src=h.EMB_FRAME_SRC+a+".html#sid="+j),e.url&&(k.id="emb_"+c.hash(e.url)),k["class"]="embedly-"+a;var l=d.create("iframe",k);c.each(g,function(a,b){l.style[b]=a});var m=i.connect(j,l,b);return m.__appended=function(){},e.sandbox===!1?m:(m.__appended=function(){var b=l.contentWindow.document,c=decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E");b.open(),b.write(c),b.close();var d=b.getElementsByTagName("head")[0],e=h.EMB_ORIGIN_BASE+"js/all."+h.EMB_ASSET_VERSION+".js",f=h.EMB_ORIGIN_BASE+"css/all."+h.EMB_ASSET_VERSION+".css",g=b.createElement("script");g.type="text/javascript",g.src=e;var i=b.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=f,m.__hub.notify(a+".load",l,b),d.appendChild(i),b.body.appendChild(g)},m)},b.exports=i},{"../a.js":1,"../browser.js":4,"../dom.js":7,"../urlparse.js":28,"../utils.js":29,conf:"conf"}],11:[function(a,b){var c=a("../utils.js"),d=a("../browser.js"),e=a("../dom.js"),f=a("./base.js"),g=a("../tunnels.js"),h={name:"button",attrs:{frameborder:"0",scrolling:"no",allowtransparency:"true",height:"20",width:"80"},styles:{border:"none"}};h.one=function(a,b){if(!c.isElement(a))return null;if(f.rendering(a))return null;var i=e.data(a,"url");c.isNone(i)&&(i=document.location.toString());var j,k={url:i};c.each(["theme","target","lang"],function(b){j=e.data(a,b),c.isNone(j)||(k[b]=j)});var l=d.window.center(635,500);k.left=l.left,k.top=l.top;var m=f.create("button",b,k,h.attrs,h.styles);return m.one("button.load",function(a){var b=function(a,b){return function(c){a.__tunnel=new g.Tunnel(a.__hub),c.create(b,a.__tunnel)}},c=b(m,k);a.contentWindow.buttons?c(a.contentWindow.buttons):a.contentWindow.onButtonsReady=c}),e.replace(a,m.elem),m.__appended(),m.on("button.click",function(){d.window.innerWidth()<=768||d.mobile()?window.location="http://embed.ly/code?url="+encodeURIComponent(k.url):b.notify("modal.create",k)}),m.on("button.ready",function(){m.ready()}),m},b.exports=h},{"../browser.js":4,"../dom.js":7,"../tunnels.js":27,"../utils.js":29,"./base.js":10}],12:[function(a,b){var c=a("../api.js"),d=a("../utils.js"),e=a("../dom.js"),f=a("../urlparse.js"),g=a("../browser.js"),h=a("../keeper.js"),i=a("./base.js"),j=a("../share.js"),k=a("../tunnels.js"),l={attrs:{frameborder:"0",scrolling:"no",allowtransparency:"true",allowfullscreen:"true"},styles:{width:"1px",height:"0px",border:"none",position:"absolute",visibility:"hidden"},extractless:/https:\/\/(\w+\.pinterest\.com\/.*)|(\w+\.reddit\.com\/r\/.*\/comments\/.*)/,sandboxless:[{re:/https?:\/\/\w+\.facebook\.com\/.*/},{re:/https?:\/\/(twitter|x)\.com\/.*/,test:function(){return g.isFirefox()}}]};l.isPercent=function(a){return/\%/i.test(a)},l.cleanWidth=function(a){a=d.trim(a);var b=/(\d+)px/i.exec(a);return b&&(a=b[1]),a},l.sandbox=function(a){var b,c;for(b=0;b<l.sandboxless.length;b++)if(c=l.sandboxless[b],c.re.test(a))return d.isFunction(c.test)?!c.test(a):!1;return!0},l.css=function(){if("undefined"!=typeof l._css)return l._css;var a=e.one("style.embedly-css");if(d.isElement(a)){var b=e.text(a);d.spaceless(b)&&(l._css="style:"+d.trim(b))}else{var c=e.one("link.embedly-css");d.isElement(c)&&c.href&&(l._css="link:"+d.trim(c.href))}return l._css||(l._css=null),l._css},l.options=function(a){if(!d.isElement(a)||!d.isElement(a.parentNode))return null;var b={sandbox:!0};d.each(["type","via","chrome","image","description","key","align","embed","controls","analytics","lang","width","referrer","theme","recommend","branding","seo","preview","comment","created"],function(c){var f=e.data(a,"card-"+c);d.isNone(f)||(b[c]=f)});var c=l.css();if(c&&(b.css=c),d.each(["recommend-1","recommend-2","recommend-3"],function(c){var f=e.data(a,"card-"+c);d.isNone(f)||(b.hasOwnProperty("recommendations")?b.recommendations.push(f):b.recommendations=[f])}),"BLOCKQUOTE"===a.nodeName){var g,h,i=e.child(a,"h4"),j=e.child(a,"p");if(d.isNone(i)){if("reddit-card"===a.className){if(h=e.toArray(a.querySelectorAll("a")),h.length>0){if(g=h[0],!g||!g.href)return!1;b.url=g.href}}else if(j){if(h=a.getElementsByTagName("a"),0===h.length)return!1;g=h[h.length-1],b.url=g.getAttribute("href")}}else g=e.child(i,"a"),b.url=g.getAttribute("href"),b.title=e.text(g),b.description=d.isNone(j)?"0":e.text(j)}else"A"===a.nodeName&&(b.url=a.getAttribute("href"));d.each(["url","image","embed"],function(a){b.hasOwnProperty(a)&&(b[a]=f.sanitize(b[a]))});var k,m,n;if(d.each(document.getElementsByTagName("meta"),function(a){n=[a.getAttribute("name"),a.getAttribute("property")],d.contains(n,"twitter:site")?m=a.getAttribute("content"):d.contains(n,"twitter:creator")&&(k=a.getAttribute("content"))}),k?b.twitter_via=k:m&&(b.twitter_via=m),!b.url)return null;var o=f.parse(b.url);return o.valid()?(b.url=o.url,b.sandbox=l.sandbox(b.url),b.referrer||(b.referrer=document.URL),b.width&&(b.width=l.cleanWidth(b.width)),/thescore\.com/.test(b.referrer)&&(b.key="900b122ee8ee43f79b2240c831f24429"),b):null};var m=function(a,b,c,d){this.init(a,b,c,d)};m.prototype.init=function(a,b,c,f){if(this.elem=b,this.options=c,!c.url)return this.error=!0,this.frame=null,!1;this.error=!1,this.frame=l.build(b,c,a),this._done=f;var g=new h,i=g.callback();this.frame.one("card.load",function(a,b){i({iframe:a,doc:b})}),this._extract=g.callback(),this.extract=d.bind(function(a){return this.extracted?!1:(this.extracted=!0,void this._extract(a))},this),c.embed&&(this.media=g.callback());var j=b.parentNode;j&&j.offsetWidth&&(this.frame.elem.style.width=j.offsetWidth>600?"600px":j.offsetWidth+"px");var k=e.create("div",{"class":"embedly-card"}),m=e.create("div",{"class":"embedly-card-hug"});k.appendChild(m),m.appendChild(this.frame.elem),j.insertBefore(k,b),this.frame.__appended(),g.wait(this.done,this)},m.prototype.done=function(a){var b=a[0].iframe,c=a[0].doc,d=a[1],e={};if(3===a.length&&(e=a[2].media),!this.frame.elem.parentNode)return!1;if(this.options.sandbox===!1)this.frame.ready(),this.frame.send("card.create",{options:this.options,extract:d,media:e});else{var f=function(a,b,d,f){return function(a){f.__tunnel=new k.Tunnel(f.__hub),a.create(c.body,{options:b,extract:d,media:e,tunnel:f.__tunnel})}},g=f(b,this.options,d,this.frame);b.contentWindow.cards?g(b.contentWindow.cards):b.contentWindow.onCardsReady=g}this.frame.options=this.options,this.frame.extract=d,this._done(this.frame)},l.fetch=function(a,b,e,f){e=d.extend({},e?e:{}),e.protocol=window.location.protocol,e=d.map(b,function(a){return e.override===!0?d.extend({},l.options(a),e):d.extend({},e,l.options(a))});var g=new h,i=[];e=d.reduce(e,function(c,d,e){var f=new m(a,b[e],d,g.callback());return l.extractless.test(d.url)?f.extract({}):f.error||c.push(d),i.push(f),c},[]);var j=d.reduce(e,function(a,b){return a.push(b.url),b.embed&&a.push(b.embed),a},[]);if(!j.length)return d.isFunction(f)&&f(d.map(i,function(a){return a.frame})),d.map(i,function(a){return a.frame});var k={card:1,v:"MTcyMDEw",youtube_showinfo:0,"native":!0},n=d.reduce(e,function(a,b){return b.key&&!a?b.key:a},null);n&&(k.key=n);var o=window.location.protocol;return e.protocol&&(o=e.protocol),o=o.split(":")[0],d.contains(["http","https"],o)||(o="https"),k.scheme=o,c.api().card(j,k,function(a){d.each(a,function(a){d.each(i,function(b){b.options.url===a.original_url?b.extract(a):b.options.embed===a.original_url&&b.media(a)})})}),g.wait(function(a){f(a)}),d.map(i,function(a){return a.frame})},l.build=function(a,b,c){var f=i.create("card",c,b,l.attrs,l.styles);return g.isFirefox()&&(f.elem.style.visibility="visible",f.elem.style.height="1px"),f.on("card.repeat",function(a){var b={url:a.url,via:document.location.toString()};d.each(["image","embed","title","description","lang"],function(c){a.hasOwnProperty(c)&&(b[c]=a[c])}),c.notify("modal.create",b)}),f.on("card.ready",function(){f.ready()}),f.on("card.rendered",function(b){if(f.url=b.url,f.type=b.type,"error"===b.name)return f.__hub.notify("card.error",a),f.remove(),!1;if(a._em_opts){var g=d.extend({},a._em_opts);if(delete a._em_opts,d.isArray(g.types)&&g.types.length>0&&!d.contains(g.types,b.type))return f.__hub.notify("card.error",a),f.remove(),!1}f.rendered=!0,!f.options.twitter_via&&b.defaultTwitterVia&&(f.options.twitter_via=b.defaultTwitterVia);var h=f.elem.parentNode;f.elem.style.display="block",f.elem.style.margin="0",f.elem.style.padding="0",f.elem.style.visibility="visible",f.elem.style.position="relative",f.elem.height=b.height?b.height:"300",b.width?l.isPercent(b.width)?(h.style.width=b.width,f.elem.width="100%"):(f.elem.width=b.width,h.style.maxWidth=b.width+"px"):(f.elem.width="600",h.style.maxWidth="600px"),h.style.padding="0",h.style.position="relative",h.style.minWidth="200px",h.style.margin="left"===b.align?"5px 0":"right"===b.align?"5px 0 5px auto":"5px auto",f.elem.style.width=null,f.elem.style.height=null,f.elem.style.maxWidth="100%",f.elem.style.minWidth="200px",e.remove(a),"error"!==b.type&&(c.notify("card.rendered",f.elem,f),b.controls&&j.card(f))}),f.one("card.error",function(a){c.notify("card.error",a)}),f.on("resize",function(){c.notify("card.resize",f.elem,f)}),f.on("log.event",function(a){c.notify("log.event",a)}),f.on("pinterest.log",function(){c.notify("pinterest.log")}),f.on("card.player.ready",function(){c.notify("card.player.ready",f)}),f.on("card.recommend.shown",function(a){c.notify("recommend.shown",f.elem,a)}),f},l.multi=function(a,b,c,e){return a=d.reduce(a,function(a,b){return i.rendering(b)?a:(a.push(b),a)},[]),l.fetch(c,a,b,function(a){d.isFunction(e)&&e(a)})},l.one=function(a,b,c,e){if(i.rendering(a))return null;var f=l.fetch(c,[a],b,function(a){d.isFunction(e)&&e(a[0])});return f[0]},b.exports=l},{"../api.js":2,"../browser.js":4,"../dom.js":7,"../keeper.js":17,"../share.js":25,"../tunnels.js":27,"../urlparse.js":28,"../utils.js":29,"./base.js":10}],13:[function(a,b){var c=a("../utils.js"),d=a("../dom.js"),e=a("../urlparse.js"),f=a("./base.js"),g=a("conf"),h={attrs:{frameborder:"0",allowtransparency:"true"},styles:{border:"none",position:"absolute",top:"-9999em",width:"10px",height:"10px"}};h.one=function(a,b){var i=c.getUUID();c.assert(b.name),b=c.extend({sid:i},b?b:{});var j=c.extend({},h.attrs);j.id="emb_xcomm",j["class"]="embedly-xcomm",j.src=g.EMB_SECURE_FRAME_SRC+"xcomm.html#"+e.createQuery(b);var k=d.create("iframe",j);c.each(h.styles,function(a,b){k.style[b]=a});var l=f.connect(i,k,a);return l.on("xcomm.ready",function(){l.ready()}),document.body.appendChild(k),l},b.exports=h},{"../dom.js":7,"../urlparse.js":28,"../utils.js":29,"./base.js":10,conf:"conf"}],14:[function(a,b){var c=a("../utils.js"),d=a("../browser.js"),e=a("./base.js"),f=a("../tunnels.js"),g={name:"modal",attrs:{frameborder:"0",allowtransparency:"true"},styles:{border:"none",position:"fixed",top:"0",left:"0",bottom:"0",right:"0",width:"100%",height:"100%",zIndex:"2147483647"}};g.one=function(a,b){if(c.isNone(a)&&(a={url:document.location.toString()}),c.isNone(a.url)&&(a.url=document.location.toString()),
a.protocol=window.location.protocol,"window"===a.target)return d.open("http://cdn.embedly.com/widgets/embed?url="+encodeURIComponent(a.url),"Embed Code",635,500),!1;a.t="card";var h=e.create("modal",b,a,g.attrs,g.styles);return h.on("modal.load",function(b){var c=function(a,b){return function(c){a.__tunnel=new f.Tunnel(a.__hub),c.create(b,a.__tunnel)}},d=c(h,a);b.contentWindow.modals?d(b.contentWindow.modals):b.contentWindow.onModalsReady=d}),h.resize=function(){},h.on("modal.close",function(){document.body.style.overflow="inherit",document.body.removeChild(h.elem)}),h.on("modal.ready",function(){h.ready()}),h.one("modal.copy",function(){b.notify("modal.copy",a)}),document.body.appendChild(h.elem),document.body.style.overflow="hidden",h.__appended(),h},b.exports=g},{"../browser.js":4,"../tunnels.js":27,"../utils.js":29,"./base.js":10}],15:[function(a,b){var c=a("../utils.js"),d=a("../api.js"),e=a("../dom.js"),f=a("../keeper.js"),g=a("./base.js"),h=a("../tunnels.js"),i={name:"slideshow",attrs:{frameborder:"0",scrolling:"no",allowtransparency:"true",allowfullscreen:"true"},styles:{width:"1px",height:"0px",border:"none",position:"absolute",visibility:"hidden"},opts:["schema","lang","width","align"]};i.options=function(a,b){if(!c.isElement(a)||!c.isElement(a.parentNode))return null;var d=c.reduce(i.opts,function(a,c){return b.hasOwnProperty(c)&&(a[c]=b[c]),a},b.options?b.options:{});return c.reduce(i.opts,function(b,d){var f=e.data(a,"slideshow-"+d);return c.isNone(f)||(b[d]=f),b},d)},i.urls=function(a,b){return c.isArray(b.urls)&&b.urls.length>0?b.urls:c.reduce(e.children(a,"blockquote"),function(a,b){if("BLOCKQUOTE"===b.nodeName){var d=e.child(b,"h4");if(!c.isNone(d)){var f=e.child(d,"a");c.isNone(f)||a.push(f.href)}}return a},[])},i.fetch=function(a,b){var c={card:1,v:1};d.api().extract(a,c,function(a){b(a)})},i.build=function(a,b,c){var d=b[0].iframe,e=b[0].doc,f=b[1],g=function(a,b,c){return function(d){a.__tunnel=new h.Tunnel(a.__hub),d.create(e.body,{options:b,extract:c,tunnel:a.__tunnel})}},i=g(c,a,f);d.contentWindow.slideshows?i(d.contentWindow.slideshows):d.contentWindow.onSlideshowsReady=i},i.one=function(a,b,d){if(!c.isElement(a))return null;if(b=b?b:{},g.rendering(a))return null;var h=i.options(a,b),j=i.urls(a,b);if(null===h||0===j.length)return null;var k=g.create("slideshow",d,h,i.attrs,i.styles),l=new f,m=l.callback(),n=l.callback();return l.wait(function(a){i.build(h,a,k)}),k.on("slideshow.load",function(a,b){m({iframe:a,doc:b})}),i.fetch(j,n),a.parentNode.insertBefore(k.elem,a),k.on("slideshow.ready",function(){k.ready()}),k.on("slideshow.rendered",function(b){return k.ready(),"error"===b.name?(k.remove(),k.__hub.notify("slideshow.error",a),!1):(k.rendered=!0,k.elem.style.display="block",k.elem.style.margin="10px auto",k.elem.style.visibility="visible",k.elem.style.position="relative",k.elem.width="700",k.elem.height=b.height?b.height:"500",k.elem.width=b.width?b.width:"700",k.elem.style.width=null,k.elem.style.height=null,k.elem.style.maxWidth="99%",k.elem.style.minWidth="300px",void e.remove(a))}),k.on("log.event",function(a){d.notify("log.event",a)}),k.__appended(),k},b.exports=i},{"../api.js":2,"../dom.js":7,"../keeper.js":17,"../tunnels.js":27,"../utils.js":29,"./base.js":10}],16:[function(a,b){var c=a("./utils.js"),d=a("./class.js"),e={senders:[],integrations:["google","kissmetrics","mixpanel","segment","heap","intercom"]};e.Sender=d.extend({init:function(){this.sent=[]},event:function(a,b,d){var e=c.reduce([a,b,d],function(a,b){return b&&(a+=b),a},"");return c.contains(this.sent,e)?!1:(this.sent.push(e),void this.send(a,b,d))},send:function(){}}),e.GoogleAnalytics=e.Sender.extend({isValid:function(){return window.ga&&c.isFunction(window.ga)},send:function(a,b,c){window.ga("send","event","Embedly > "+a,b,c)}}),e.KissMetrics=e.Sender.extend({isValid:function(){return window._kmq&&c.isFunction(window._kmq.push)},send:function(a,b,c){window._kmq.push(["record","Embedly > "+a+" > "+b,{url:c}])}}),e.Mixpanel=e.Sender.extend({isValid:function(){return window.mixpanel&&c.isFunction(window.mixpanel.push)},send:function(a,b,c){window.mixpanel.push(["track","Embedly > "+a+" > "+b,{url:c}])}}),e.Segment=e.Sender.extend({isValid:function(){return window.analytics&&c.isFunction(window.analytics.track)},send:function(a,b,c){window.analytics.track("Embedly > "+a+" > "+b,{url:c})}}),e.Heap=e.Sender.extend({isValid:function(){return window.heap&&c.isFunction(window.heap.track)},send:function(a,b,c){window.heap.track("Embedly > "+a+" > "+b,{url:c})}}),e.Intercom=e.Sender.extend({isValid:function(){return window.Intercom&&c.isFunction(window.Intercom)},send:function(a,b,c){window.Intercom("trackEvent","Embedly > "+a+" > "+b,{url:c})}}),e._integrations={google:e.GoogleAnalytics,kissmetrics:e.KissMetrics,mixpanel:e.Mixpanel,segment:e.Segment,heap:e.Heap,intercom:e.Intercom},e.send=function(a,b,d){c.each(e.senders,function(c){c.isValid()&&c.event(a,b,d)}),e.hub&&e.hub.notify("analytics.event",a,b,d)},e.player=function(a){a.on("play",function(){e.send("Video","Play",a.url)}),a.on("timeupdate",function(b){if(b.seconds&&b.duration&&c.isNumber(b.seconds)&&c.isNumber(b.duration)){var d=parseInt(b.seconds/b.duration*4,10);d&&d>0&&5>d&&e.send("Video",c.fmt("{n}% Watched",{n:(25*d).toString()}),a.url)}}),a.on("ended",function(){e.send("Video","100% Watched",a.url)})},e.event=function(a,b,d){return a&&b&&d&&"click"===b?(c.contains(["facebook","twitter","pinterest","repeat"],a)&&(b=a,a="social"),"article-full"===a&&(a="article"),c.contains(["video","image","rich","article","product","social","recommend"],a)?(a=c.capitalize(a),b=c.capitalize(b),void e.send(a,b,d)):!1):!1},e.configure=function(a){a&&c.isArray(a)||(a=[]),e.senders=[],c.each(a,function(a){if(c.isString(a)){if(e._integrations.hasOwnProperty(a)){var b=e._integrations[a];e.senders.push(new b)}}else if(c.isFunction(a)){var d=e.Sender.extend({isValid:function(){return!0},send:a});e.senders.push(new d)}})},e.connect=function(a){a.on("media.player",e.player),c.each(e.integrations,function(a){if(e._integrations.hasOwnProperty(a)){var b=e._integrations[a];e.senders.push(new b)}}),e.hub=a,a.on("log.event",function(a){if(a&&a.a&&"click"===a.a)if("recommend"===a.c&&a.l){var b=a.l.split("|");3===b.length&&e.event(a.c,a.a,b.slice(1).join(" "))}else e.event(a.c,a.a,a.u)})},b.exports=e},{"./class.js":5,"./utils.js":29}],17:[function(a,b){var c=a("./utils.js"),d=function(){this.init()};d.prototype.init=function(){this.len=0,this.count=0,this.results={},this.finished=!1,this.started=!1},d.prototype.callback=function(){var a=this.len;return this.len++,c.bind(function(b){this.each(a,b)},this)},d.prototype.done=function(){if(!this.started)return!1;if(this.finished)return!0;if(this.count===this.len){this.finished=!0;for(var a=[],b=0;b<this.len;b++)a.push(this.results[b]);return this.func.call(this.ctx,a),!0}},d.prototype.each=function(a,b){this.results[a]=b,this.count++,this.done()},d.prototype.wait=function(a,b){this.func=a,this.ctx=b?b:null,this.started=!0,this.done()},b.exports=d},{"./utils.js":29}],18:[function(a,b){var c={};c.addReddit=function(){window.libringEventAPI=window.libringEventAPI||{track:function(a,b,c){try{var d=new XMLHttpRequest;d.open("POST","https://eventapi.libring.com/v1/event",!0),d.setRequestHeader("Content-type","text/plain"),d.send('{"accessCode":"7AMXYZIYIVEDFM3CRPHEH33WQQ","data":[{"eventType":"'+a+'","values":{"url":"'+b+'","category":"'+c+'"}}]}')}catch(e){return!1}}}},b.exports=c},{}],19:[function(a,b){var c=a("../utils.js"),d=a("../browser.js"),e=a("../comms.js"),f={hub:null,timeout:null,sid:null,connected:!1,connecting:!1,_queue:[]};f.release=function(){var a=f._queue;f._queue=[],d.console.log("log.release",a),f.hub.notify("xcomm.log.event",{events:a})},f.queue=function(a){clearTimeout(f.timeout),f._queue.push(a),f.comms()&&(f.timeout=setTimeout(function(){f.release()},50))},f.event=function(a){var b={t:c.getTimestamp()};window.self===window.top?(b.r=document.location.toString(),b.rr=document.referrer):b.r=document.referrer,c.assert(a.g),c.assert(a.c),c.assert(a.a),b=c.extend({},b,a),"reddit"!==b.c||"load"!==b.a&&"click"!==b.a&&"view"!==b.a||!window.libringEventAPI||window.libringEventAPI.track(b.a,b.u,b.r)},f.comms=function(){return f.connected?!0:f.hub?f.connecting?!1:(f.connecting=!0,f.hub.one("xcomm.ready",function(){f.connected=!0,f.release()}),void e.connect(f.hub,{name:f.name})):!1},f.connect=function(a,b){f.name=b,f.sid||(f.sid=c.getUUID()),a.on("log.event",function(a){f.event(a)}),f.hub=a},b.exports=f},{"../browser.js":4,"../comms.js":6,"../utils.js":29}],20:[function(a,b){var c=a("./dom.js"),d=a("./utils"),e={_event:null,_observer:null};e.nodeNames=["iframe","a","blockquote"],e.html=function(){var a=document.getElementsByTagName("html");return 0===a.length?null:a[0]},e.recurse=function(a){var b=[];return d.isElement(a)&&b.push(a),d.reduce(a.childNodes,function(a,b){return d.isElement(b)?a.concat(e.recurse(b)):a},b)},e.observer=function(a){var b=e.html();if(null===b)return!1;if(!window.MutationObserver)return!1;e._observer=new window.MutationObserver(function(b){d.each(b,function(b){if("childList"===b.type&&b.addedNodes){var c=Array.prototype.slice.call(b.addedNodes);d.each(c,function(b){d.each(e.recurse(b),function(b){b.nodeName&&d.contains(e.nodeNames,b.nodeName.toLowerCase())&&a.notify("mutation.insert."+b.nodeName.toLowerCase(),b)})})}})});var c={childList:!0,subtree:!0};return e._observer.observe(b,c),!0},e.events=function(a){var b=e.html();return null===b?!1:(e._event=function(b){d.each(e.recurse(b.target),function(b){b.nodeName&&d.contains(e.nodeNames,b.nodeName.toLowerCase())&&a.notify("mutation.insert."+b.nodeName.toLowerCase(),b)})},c.addEvent(b,"DOMNodeInserted",e._event),!0)},e.stop=function(){var a=e.html();return null===a?!1:(e._event&&(c.detachEvent(a,"DOMNodeInserted",e._event),e._event=null),void(e._observer&&(e._observer.disconnect(),e._observer=null)))},e.connect=function(a){return e._event||e._observer?!1:void(e.observer(a)||e.events(a))},b.exports=e},{"./dom.js":7,"./utils":29}],21:[function(a,b){var c=a("./utils.js"),d=a("./urlparse.js"),e=a("./comms.js"),f=a("conf"),g={started:!1};g.connect=function(a,b){var h=d.getDomain(document.location.toString());if(!b&&f.PAGE_PROGRESS_DOMAINS&&!c.contains(f.PAGE_PROGRESS_DOMAINS,h))return!1;if(g.started)return!1;g.started=!0;var i=function(){a.get("xcomm.page.progress",function(){a.notify("xcomm.page.progress.started")})};e.started?i():(e.connect(a,{name:"platform"}),a.one("xcomm.ready",i))},b.exports=g},{"./comms.js":6,"./urlparse.js":28,"./utils.js":29,conf:"conf"}],22:[function(a,b){function c(a){return function(){var b={method:a},c=Array.prototype.slice.call(arguments);/^get/.test(a)?(d.assert(c.length>0,"Get methods require a callback."),c.unshift(b)):(/^set/.test(a)&&(d.assert(0!==c.length,"Set methods require a value."),b.value=c[0]),c=[b]),this.send.apply(this,c)}}var d=a("./utils.js"),e=a("./browser.js"),f={};f.CONTEXT="player.js",f.VERSION="0.0.11",f.bound=function(a,b){return function(c){a.call(b||window,c.value)}},f.Player=function(a){return this instanceof f.Player?void this.init(a):new f.Player(a)},f.EVENTS={READY:"ready",PLAY:"play",PAUSE:"pause",ENDED:"ended",TIMEUPDATE:"timeupdate",PROGRESS:"progress",ERROR:"error"},f.EVENTS.all=function(){return d.map(f.EVENTS,function(a){return a})},f.METHODS={PLAY:"play",PAUSE:"pause",GETPAUSED:"getPaused",MUTE:"mute",UNMUTE:"unmute",GETMUTED:"getMuted",SETVOLUME:"setVolume",GETVOLUME:"getVolume",GETDURATION:"getDuration",SETCURRENTTIME:"setCurrentTime",GETCURRENTTIME:"getCurrentTime",SETLOOP:"setLoop",GETLOOP:"getLoop",REMOVEEVENTLISTENER:"removeEventListener",ADDEVENTLISTENER:"addEventListener"},f.METHODS.all=function(){return d.map(f.METHODS,function(a){return a})},f.READIED=[],f.Player.prototype.init=function(a){this.frame=a,this.url=a.url,this.events=f.EVENTS.all(),this.methods=f.METHODS.all()},f.Player.prototype.send=function(a,b,c){return a.context=f.CONTEXT,a.version=f.VERSION,b?(a.listener="l"+d.getUUID(),this.frame.one({event:a.method,listener:a.listener},f.bound(b,c),c)):this.frame.on(a.method,b,c),this.frame.send(a.method,a),!0},f.Player.prototype.on=function(a,b,c){var e=d.getUUID(),g={event:a,listener:e};return"ready"===a?this.frame.one(g,f.bound(b,c),c):this.frame.on(g,f.bound(b,c),c),this.frame.send("addEventListener",{event:"addEventListener",value:a,listener:e,context:f.CONTEXT,version:f.VERSION}),!0},f.Player.prototype.off=function(a){var b=this.frame.__hub.listeners(a);if(e.console.log("Player.off",b),b.length>0)for(var c in b)this.send({method:"removeEventListener",value:a,listener:b[c]}),this.frame.__hub.off([a,b[c]].join("."));return!1},f.Player.prototype.supports=function(a,b){d.assert(d.indexOf(["method","event"],a)>-1,'evtOrMethod needs to be either "event" or "method" got '+a),b=d.isArray(b)?b:[b];for(var c="event"===a?this.events:this.methods,e=0;e<b.length;e++)if(-1===f.indexOf(c,b[e]))return!1;return!0},d.each(f.METHODS.all(),function(a){f.Player.prototype.hasOwnProperty(a)||(f.Player.prototype[a]=c(a))}),f._all=[],f.get=function(a,b,c){var e=function(a,b){return function(c,d){return a&&d!==a?!1:void b.call(window,c,a)}}(b,c);d.each(f._all,function(a){e(a.player,a.elem)}),a.on("media.player",e)},f.add=function(a,b){var c=new f.Player(b);a.notify("media.player",c,b.elem),f._all.push({player:c,elem:b.elem})},f.connect=function(a){a.on("media.player.init",function(b){f.add(a,b)}),a.on("card.player.ready",function(b){f.add(a,b)})},b.exports=f},{"./browser.js":4,"./utils.js":29}],23:[function(a,b){var c=a("./utils.js"),d=a("./browser.js"),e=a("./dom.js"),f=function(){this.init()};f.prototype.init=function(){var a=this;document.addEventListener?document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),a.ready()},!1):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),a.ready())}),document.documentElement.doScroll&&window===window.top&&!function(){if(!a.isReady){try{document.documentElement.doScroll("left")}catch(b){return void setTimeout(arguments.callee,0)}a.ready()}}()),e.addEvent(window,"load",a.ready)},f.prototype.ready=function(){return this.isReady?!1:(this.isReady=!1,void(this.callback&&this.callback()))},f.prototype.bind=function(a){this.isReady&&a(),this.callback=a},f.prototype.elem=function(a,b,c){var d=!1,f=function(){d===!1&&(d=!0,b.call(c))};return a.onload=f,e.addEvent(a,"load",f),a.onreadystatechange=function(){var b=a.readyState;("loaded"===b||"complete"===b)&&(a.onreadystatechange=null,f())},f},f.prototype.firstNode=function(){var a=document.getElementsByTagName("head")[0],b=e.child(a,"link");if(b)return b;var c=e.child(a,"style");if(c)return c;var d=e.child(a,"script");return d?d:null},f.prototype.appendToHead=function(a){var b=this.firstNode();if(null===b){var c=document.getElementsByTagName("head")[0];c?c.appendChild(a):document.body.appendChild(a)}else b.parentNode.insertBefore(a,b)},f.prototype.script=function(a,b,d,e){var f=document.createElement("script");return f.type="text/javascript",f.src=a,c.isNone(e)||c.each(e,function(a,b){f.setAttribute(b,a)}),this.elem(f,b,d),this.appendToHead(f),f},f.prototype.css=function(a,b,c){var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=a;var f=this.elem(e,b,c);this.appendToHead(e),d.isPhantom()&&f()},b.exports=new f},{"./browser.js":4,"./dom.js":7,"./utils.js":29}],24:[function(a,b){var c=a("../urlparse.js"),d=a("../utils.js"),e={enabled:!1,defaults:{},options:{},_queue:{}};e.queue=function(a,b,c){b?b.send(a):e._queue.hasOwnProperty(c)?e._queue[c].push(a):e._queue[c]=[a]},e.add=function(a,b){var f=c.getQuery(a.elem.src);if(e.enabled){var g={key:f.key,media:f.url,url:document.location.toString()};e.options.hasOwnProperty(a.elem)&&(g=d.extend(g,e.options[a.elem])),g=d.extend(g,e.defaults),a.send("media.recommend",g),a.on("media.recommend.shown",function(c){b.notify("recommend.shown",a.elem,c)}),e._queue.hasOwnProperty(a.elem)&&(d.each(e._queue[a.elem],function(b){a.send(b)}),delete e._queue[a.elem])}},e.connect=function(a){a.on("media.recommend.options",function(b,c,f){e.enabled=!0,null===b?e.defaults=c:d.isElement(b)&&(e.options[b]=c),d.each(f,function(b){a.notify("media.recommend.add",b)})}),a.on("media.recommend.add",function(b){e.add(b,a)}),a.on("media.recommend.show",function(a,b){e.queue("media.recommend.show",a,b)}),a.on("media.recommend.destroy",function(a,b){e.queue("media.recommend.destroy",a,b)}),a.on("media.recommend.resize",function(a,b){if(!b.height)return!1;var c=a.parentNode,e=window.getComputedStyle(c),f=window.getComputedStyle(a),g=["relative"===e.position,e.paddingBottom===e.height||e.paddingTop===e.height,"absolute"===f.position];if(d.every(g)){var h=parseInt(f.width,10),i=(b.height/h*100).toPrecision(8)+"%",j=parseInt(e.paddingTop,10),k=parseInt(e.paddingBottom,10);j>k?c.style.paddingTop=i:c.style.paddingBottom=i}else a.style.maxHeight="none",a.height=b.height,a.style.height=b.height.toString()+"px"})},b.exports=e},{"../urlparse.js":28,"../utils.js":29}],25:[function(a,b){var c=a("./utils.js"),d=a("./dom.js"),e=a("./ready.js"),f=a("./urlparse.js"),g=a("./log/front.js"),h=a("conf"),i={_css:!1,hub:null};i.connect=function(a){i.hub=a},i.log=function(a,b){i.hub.notify("log.event",{u:a,g:"card",a:"click",c:b,l:c.hash(g.sid)})},i.url=function(a){if(a){var b=["e",c.hash(a),c.hash(g.sid)].join(".");return f.addHash(document.URL,b)}},i.buttons=function(a){var b,e=d.create("div",{"class":"embdscl0"});return c.each(["facebook","twitter","pinterest","linkedin","card"],function(c){b=d.create("a",{"class":"embd-"+c}),b.innerHTML="<i></i>",i.buttons[c].call(window,b,a)===!0&&e.appendChild(b)}),e},i.buttons.twitter=function(a,b){var e=b.options.url,g=b.extract.title,h=b.options.twitter_via,j={url:i.url(e)};return g&&(j.text=c.truncate(g,100)),j.via=h?"@"===h.substr(0,1)?h.substr(1):h:"embedly",a.href="https://twitter.com/intent/tweet?"+f.createQuery(j),d.addEvent(a,"click",function(c){var e=d.event(c);e.stop(),window.open(a.href,"_blank","width=550,height=410,top=150,left=150"),i.log(b.options.url,"twitter")}),!0},i.buttons.facebook=function(a,b){var c={u:i.url(b.options.url)};return a.href="https://www.facebook.com/sharer/sharer.php?"+f.createQuery(c),d.addEvent(a,"click",function(c){var e=d.event(c);e.stop(),window.open(a.href,"_blank","width=700,height=425,top=150,left=150"),i.log(b.options.url,"facebook")}),!0},i.buttons.pinterest=function(a,b){var c,e="https://www.pinterest.com/pin/create/button/";if(b.options.image)c=b.options.image;else if(b.extract.media&&"photo"===b.extract.media.type)c=b.extract.media.url;else{if(!(b.extract.images&&b.extract.images.length>0))return!1;c=b.extract.images[0].url}return a.href=f.appendQuery(e,{url:i.url(b.options.url),media:c,description:b.extract.title}),d.addEvent(a,"click",function(c){var e=d.event(c);e.stop(),window.open(a.href,"_blank","width=700,height=425,top=150,left=150"),i.log(b.options.url,"pinterest")}),!0},i.buttons.card=function(a,b){return d.addEvent(a,"click",function(a){var e=d.event(a);e.stop();var f={url:b.options.url};c.each(["image","embed","title","description","lang"],function(a){b.options.hasOwnProperty(a)&&(f[a]=b.options[a])}),b.__hub.notify("card.repeat",f),i.log(b.options.url,"repeat")}),!0},i.buttons.linkedin=function(a,b){var c={url:i.url(b.options.url),mini:"true"};return a.href="https://www.linkedin.com/shareArticle?"+f.createQuery(c),d.addEvent(a,"click",function(c){var e=d.event(c);e.stop(),window.open(a.href,"_blank","width=700,height=425,top=150,left=150"),i.log(b.options.url,"linkedin")}),!0},i.buttons.embedly=function(a,b){var c={utm_source:f.getDomain(document.URL),utm_medium:"referral",utm_campaign:"cards"};return a.href=f.appendQuery("http://embed.ly/cards",c),a.target="_blank",d.addEvent(a,"click",function(){i.log(b.options.url,"whats-this")}),!0},i.css=function(a){if(!i._css){i._css=!0;var b=h.EMB_ORIGIN_BASE+"css/social."+h.EMB_ASSET_VERSION+".css";return e.css(b,a),!1}a()},i.card=function(a){var b=a.elem.parentNode;return!c.isElement(b)||"DIV"!==b.nodeName&&!d.hasClass(b,"embedly-card")?!1:void i.css(function(){var c=i.buttons(a);d.addEvent(b,"mouseenter",function(){d.addClass(c,"embd-active")}),d.addEvent(b,"mouseleave",function(){d.removeClass(c,"embd-active")}),b.appendChild(c),a.__hub.notify("card.share.init")})},b.exports=i},{"./dom.js":7,"./log/front.js":19,"./ready.js":23,"./urlparse.js":28,"./utils.js":29,conf:"conf"}],26:[function(a,b){var c=a("./utils.js"),d=a("./urlparse.js"),e=a("conf"),f={};f.youtube={schema:"youtube",re:/youtube\.com\/embed\/([^\/?#]+)/i,url:function(a){var b=f.youtube.re.exec(a);return 2!==b.length?a:"http://www.youtube.com/watch?v="+b[1]}},f.vimeo={schema:"vimeo",re:/player\.vimeo\.com\/video\/([^\/?#]+)/i,url:function(a){var b=f.vimeo.re.exec(a);return 2!==b.length?a:"http://vimeo.com/"+b[1]}},f.soundcloud={schema:"soundcloud",re:/w\.soundcloud\.com\/player\/\?/,url:function(a){var b=d.getQuery(a);if(b.url){var c=/api\.soundcloud\.com\/tracks\/([^\/?#]+)/.exec(b.url);if(2===c.length)return"https://soundcloud.com/track/"+c[1]}return a}},f.providers=[f.youtube,f.vimeo,f.soundcloud],f.provider=function(a){return c.reduce(f.providers,function(b,c){return c.re.test(a)?c:b},null)},f.replace=function(a,b){if(c.isNone(a)||!c.isElement(a))return null;if("IFRAME"!==a.nodeName)return null;if(!a.src||!c.isString(a.src))return null;if(!b.key)return!1;var g=a.src;g=g.replace(/&amp;/g,"&");var h=f.provider(g);if(null===h)return null;var i="https:"===window.location.protocol?"https:":"http:";"file://"===g.substr(0,7)&&(g=g.substr(5)),"//"===g.substr(0,2)&&(g=i+g);var j=c.extend({},b,{url:h.url(g),src:g,schema:h.schema,type:"text/html"}),k=i+"//cdn.embedly.com/widgets/";e.EMB_DEBUG&&(k=e.EMB_FRAME_SRC);var l=k+"media.html?"+d.createQuery(j);return a.src=l,a},b.exports=f},{"./urlparse.js":28,"./utils.js":29,conf:"conf"}],27:[function(a,b){var c=a("./utils.js"),d={};d.Tunnel=function(a){this.init(a)},d.Tunnel.prototype.init=function(a){this.parent=a,this.child=null,this.ready=!1,this.queue=[]},d.Tunnel.prototype.connect=function(a){this.child=a,this.child.on("receiver.send",c.bind(function(a,b){c.isNone(b)&&(b={}),b.method=a,setTimeout(c.bind(function(){this.parent.notify("message",b)},this),1)},this)),this.ready=!0,this.release()},d.Tunnel.prototype.release=function(){for(var a=0;a<this.queue.length;a++)this.send(this.queue[a]);this.queue=[]},d.Tunnel.prototype.send=function(a){return this.ready?void setTimeout(c.bind(function(){this.child.notify(a.method,a)},this),1):(this.queue.push(a),!1)},d.Tunnel.prototype.clear=function(){this.ready=!1,this.parent.clear(),this.child&&this.child.clear()},b.exports=d},{"./utils.js":29}],28:[function(a,b){var c=a("./utils.js"),d={};d.createQuery=function(a){var b=[],d="";return a&&c.isObject(a)&&!c.isEmptyObject(a)?(c.each(a,function(a,c){b.push(encodeURIComponent(c)+"="+encodeURIComponent(a))}),b.sort(),b.join("&")):d},d.parseQuery=function(a){var b={};if(!a||!c.isString(a))return b;("#"===a.substr(0,1)||"?"===a.substr(0,1))&&(a=a.substr(1));var d=a.split("&");return c.each(d,function(a){if(!a)return!0;var c=a.split("="),d=decodeURIComponent(c[0]);b[d]=1===c.length?"":decodeURIComponent(2===c.length?c[1]:c.slice(1).join("="))}),b},d.getQuery=function(a){if(!a||!c.isString(a))return{};var b=a.split("?");return 2===b.length?d.parseQuery(b[1]):b.length>2?d.parseQuery(b.slice(1).join("?")):{}},d.appendQuery=function(a,b){if(!a||!c.isString(a))return null;var e=a.split("?"),f=e[0];if(!b||!c.isObject(b)||c.isEmptyObject(b))return a;var g=d.getQuery(a);return g=c.extend(g,b),c.isEmptyObject(g)?a:[f,d.createQuery(g)].join("?")},d.removeQuery=function(a,b){if(!a||!c.isString(a))return null;var e=a.split("?"),f=e[0],g=d.getQuery(a);return g.hasOwnProperty(b)&&delete g[b],c.isEmptyObject(g)?f:[f,d.createQuery(g)].join("?")},d.getOrigin=function(a){if(!a||!c.isString(a))return null;if(!/^https?:\/\//.test(a))return null;var b=a.split("/").slice(0,3).join("/");return-1===b.indexOf(".")&&-1===b.indexOf(":")?null:b},d.getDomain=function(a){var b=d.getOrigin(a);return b?b.replace(/^https?:\/\//,""):null},d.param=function(a){return c.map(a,function(a,b){return encodeURIComponent(b)+"="+encodeURIComponent(a)}).join("&")},d.Parsed=function(a,b){this.init(a,b)},d.Parsed.prototype.init=function(a,b){this.original=a,this.url=b,this._valid=!1,this.url=b},d.Parsed.prototype.valid=function(a){return(a===!0||a===!1)&&(this._valid=a),this._valid},d.parse=function(a){var b=a,e="https:"===window.location.protocol?"https:":"http:";a=a?c.trim(a):a;var f=new d.Parsed(b,a);return a?/^https?:\/\/[^\/]+\.[^\/]/i.test(a)?(f.valid(!0),f):/^\w+:/i.test(a)?f:"#"===a[0]?f:/^\/\/[^\/]+\.[^\/]/i.test(a)?(f.valid(!0),f.url=e+a,f):/^\/([^\/]+|$)/i.test(a)?(f.valid(!0),f.url=d.getOrigin(window.location.toString())+a,f):/^[^\/]+\.[^\/]/i.test(a)?(f.valid(!0),f.url="http://"+a,f):f:f},d.addHash=function(a,b){return-1===a.indexOf("#")?a+"#"+b:a+"&"+b},d.sanitize=function(a){return a?(a=a.replace(/#x\d\d;/,""),a.replace(/[^-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]/g,"")):a},b.exports=d},{"./utils.js":29}],29:[function(a,b){var c=a("conf"),d={},e={},f=Array.prototype,g=Object.prototype,h=Function.prototype,i=f.slice,j=g.toString,k=f.forEach,l=f.reduce,m=f.every,n=f.indexOf,o=h.bind;d.identity=function(a){return a},d.each=function(a,b,c){if(null!=a)if(k&&a.forEach===k)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,f=a.length;f>d;d++)if(d in a&&b.call(c,a[d],d,a)===e)return}else for(var h in a)if(g.hasOwnProperty.call(a,h)&&b.call(c,a[h],h,a)===e)return},d.map=function(a,b,c){var e=[];return null==a?e:Array.prototype.map&&a.map===Array.prototype.map?a.map(b,c):(d.each(a,function(a,d,f){e[e.length]=b.call(c,a,d,f)}),e)},d.reduce=function(a,b,c,e){var f=arguments.length>2;if(null==a&&(a=[]),l&&a.reduce===l)return e&&(b=d.bind(b,e)),f?a.reduce(b,c):a.reduce(b);if(d.each(a,function(a,d,g){f?c=b.call(e,c,a,d,g):(c=a,f=!0)}),!f)throw new TypeError("Reduce of empty array with no initial value");return c},d.zip=function(a){return d.map(a[0],function(b,c){return b.map(a,function(a){return a[c]})})},d.extend=function(a){return d.each(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},d.contains=function(a,b){if(!n){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1}return a.indexOf(b)>-1},d.every=function(a,b,c){b||(b=d.identity);var f=!0;return null==a?f:m&&a.every===m?a.every(b,c):(d.each(a,function(a,d,g){return(f=f&&b.call(c,a,d,g))?void 0:e}),!!f)},d.indexOf=function(a,b){if(null==a)return-1;var c=0,d=a.length;if(n&&a.indexOf===n)return a.indexOf(b);for(;d>c;c++)if(a[c]===b)return c;return-1},d.batch=function(a,b){var c=[],e=[];return d.each(a,function(a){e.push(a),e.length===b&&(c.push(e),e=[])}),0!==e.length&&c.push(e),c};var p=function(){};d.bind=function(a,b){var c,e;if(o&&a.bind===o)return o.apply(a,i.call(arguments,1));if(!d.isFunction(a))throw new TypeError;return c=i.call(arguments,2),e=function(){if(!(this instanceof e))return a.apply(b,c.concat(i.call(arguments)));p.prototype=a.prototype;var d=new p;p.prototype=null;var f=a.apply(d,c.concat(i.call(arguments)));return Object(f)===f?f:d}},d.get=function(a,b,c){if(c=d.isNone(c)?null:c,d.isNone(b)||!d.isString(b)||!a)return c;if(""===b)return a;var e=b.split("."),f=e.splice(0,1)[0];return a.hasOwnProperty(f)?d.get(a[f],e.join("."),c):c},d.isFunction=function(a){try{return/^\s*\bfunction\b/.test(a)}catch(b){return!1}},d.isNone=function(a){return null===a||"undefined"==typeof a},d.isString=function(a){return"[object String]"===j.call(a)},d.isNumber=function(a){return"[object Number]"===j.call(a)},d.isDate=function(a){return"[object Date]"===j.call(a)},d.isObject=function(a){return"[object Object]"===j.call(a)},d.isArray=function(a){return"[object Array]"===j.call(a)},d.isElement=function(a){return!d.isNone(a)&&!d.isNone(a.nodeType)&&1===a.nodeType},d.isEmptyObject=function(a){if(d.isObject(a)){for(var b in a)if(g.hasOwnProperty.call(a,b))return!1;return!0}return!1},d.bool=function(a){return d.isNone(a)?null:"true"===a||"yes"===a||"1"===a||1===a||a===!0?!0:"false"===a||"no"===a||"0"===a||0===a||a===!1?!1:null},d.assert=function(a,b){if(!a)throw b||"Assertion Failed"},d.getUUID=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},d.getTimestamp=function(){var a=new Date;return a.getTime()},d.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},d.spaceless=function(a){return a.replace(/\s+/g,"")},d.capitalize=function(a){return a.charAt(0).toUpperCase()+a.substr(1)},d.camelCase=function(a,b){var c=a.split("-");return b=b?b:c.length,c.length>1&&(a=c.splice(0,1)[0],a+=d.map(c.splice(0,b),function(a){return a[0].toUpperCase()+a.substr(1)}).join(""),c.length>0&&(a+="-"+c.join("-"))),a},d.truncate=function(a,b){return a?(b=b?b:50,a.length<b?a:(a=a.substr(0,b-3),d.trim(a)+"...")):""},d.fmt=function(a,b){return a.replace(/{(\w+)}/g,function(a,c){return b[c]?b[c]:""})},d.fullHash=function(a){var b,c,d,e=0;if(!a||0===a.length)return e;for(b=0,d=a.length;d>b;b++)c=a.charCodeAt(b),e=(e<<5)-e+c,e|=0;return Math.abs(e).toString(32)},d.hash=function(a){var b="0000000"+d.fullHash(a);return b.substr(b.length-6)},d.rgbToHex=function(a,b,c){return"#"+((1<<24)+(a<<16)+(b<<8)+c).toString(16).slice(1)},c.EMB_DEBUG===!0&&(window._=d),b.exports=d},{conf:"conf"}],30:[function(a,b){var c=a("./utils.js"),d=a("./dom.js"),e=a("./browser.js"),f=function(){this.init()};f.prototype.init=function(){this._elements=[],this._listening=!1},f.prototype.viewable=function(a){if(!a.getBoundingClientRect)return!0;var b;try{b=a.getBoundingClientRect()}catch(c){return!1}return b.bottom>=0&&b.right>=0&&b.top<=(window.innerHeight||document.documentElement.clientHeight)&&b.left<=(window.innerWidth||document.documentElement.clientWidth)},f.prototype.check=function(){this.freeze=!0;var a=[];c.each(this._elements,c.bind(function(b,c){if(this.viewable(b.elem)){try{b.func.call(this)}catch(d){e.console.log(d)}a.push(c)}},this)),c.each(a,function(a){this._elements.splice(a,1)},this),0===this._elements.length&&this.stop(),this.freeze=!1},f.prototype.stop=function(){try{d.detachEvent(window,"DOMContentLoaded",this.handler),d.detachEvent(window,"load",this.handler),d.detachEvent(window,"resize",this.handler),d.detachEvent(window,"scroll",this.handler)}catch(a){}this.handler=null,this._listening=!1},f.prototype.listen=function(){return this._listening?!1:(this._listening=!0,this.handler=c.bind(function(){!this.freeze&&this._elements.length&&this.check()},this),d.addEvent(window,"DOMContentLoaded",this.handler),d.addEvent(window,"load",this.handler),d.addEvent(window,"resize",this.handler),void d.addEvent(window,"scroll",this.handler))},f.prototype.on=function(a,b,c){"viewable"===a&&(this._elements.push({elem:b,func:c}),this.listen(),this.check())},b.exports=f},{"./browser.js":4,"./dom.js":7,"./utils.js":29}],31:[function(a){if(window.embedly&&window.embedly.look)return window.embedly.look(),!1;var b=a("./common/iframes/all.js"),c=a("./common/browser.js"),d=a("./common/utils.js"),e=a("./common/a.js"),f=a("./common/dom.js"),g=a("./common/ready.js"),h=a("./common/viewport.js"),i=a("./common/page.js"),j=a("./common/found.js"),k=a("./common/share.js"),l=a("./common/log/front.js"),m=a("./common/recommend/front.js"),n=a("./common/players.js"),o=a("./common/integrate.js"),p=a("./common/blacklist.js"),q=a("./common/libring.js"),r=new e,s=new h;m.connect(r),k.connect(r),q.addReddit(),n.connect(r),o.connect(r),l.connect(r,"platform");var t=function(){var a=/emb_(\d+)/.exec(c.location.hash());return a?a[1]:null},u={analytics:null,recommend:!1,shared:t(),defaults:{cards:{}}},v={media:[]},w=function(a){var b;try{b=JSON.parse(a.data)}catch(d){return c.console.error(d),!1}r.notify("window.message",a,b);

};f.addEvent(window,"message",w);var x=function(a,c,e){var f;if(d.isFunction(c)&&(e=c,c={}),d.isString(a)||!d.isElement(a)&&d.isObject(a))return j.add.cards(a),!0;if(d.isElement(a)&&("a"===a.nodeName.toLowerCase()||"blockquote"===a.nodeName.toLowerCase())){var g=d.extend({},u.defaults.cards,c);f=b.cards.one(a,g,r,function(a){d.isFunction(e)&&e.call(a,a)})}return f},y=function(a){var c;return d.isString(a)?(j.add.button(a),!0):(d.isElement(a)&&"a"===a.nodeName.toLowerCase()&&(c=b.button.one(a,r)),c&&c.on("button.rendered",function(){r.notify("button.rendered",c.elem,c)}),c)},z=function(a,c){var e;e=d.isString(a)?{url:a}:a;var f=b.modal.one(e,r);return d.isFunction(c)&&c.call(f,f),f},A=function(a,c,e){var f=b.slideshow.one(a,c,r);return d.isFunction(e)&&e.call(f,f),f},B=function(a){if("1"===f.data(a,"connected"))return!1;f.data(a,"connected","1");var c=b.connect(null,a,r);c.one("media.ready",function(a){c.url=a.url,c.ready(),s.on("viewable",c.elem,function(){c.send("media.view")}),r.notify("media.recommend.add",c),v.media.push(c),a.controllable&&r.notify("media.player.init",c),r.notify("media.ready",c)}),c.on("media.recommend.resize",function(b){r.notify("media.recommend.resize",a,b)}),c.on("iframe.resize",function(a){a.height&&(c.elem.height=a.height),r.notify("media.resize",c)}),c.send("media.ready",{},!0)},C=function(a){return a&&a.key?(j.analytics=a,void j.look()):!1},D=function(a,b){if(!d.isElement(a))return!1;if(d.isString(b)){var c=!1;d.each(v.media,function(d){d.elem===a&&(c=!0,r.notify("media.recommend."+b,d,d.elem))}),c||r.notify("media.recommend."+b,null,a)}else d.isObject(b)&&r.notify("media.recommend.options",a,b,v.media);j.look()},E=function(a){return d.isString(a)&&"reset"===a?(u.defaults.cards={},!1):d.isObject(a)?(a.hasOwnProperty("cards")&&d.isObject(a.cards)&&(u.defaults.cards=d.extend({},u.defaults.cards,a.cards)),a.hasOwnProperty("recommend")&&(r.notify("media.recommend.options",null,a.recommend,v.media),d.each(v.media,function(a){r.notify("media.recommend.add",a)})),void(a.hasOwnProperty("integrations")&&o.configure(a.integrations))):!1},F=function(a,b){d.isFunction(a)&&(b=a,a=null),n.get(r,a,b)};r.on("found",function(a){a.cards&&a.cards.length&&b.cards.multi(a.cards,u.defaults.cards,r),a.buttons&&a.buttons.length&&d.each(a.buttons,function(a){y(a)}),a.slideshows&&a.slideshows.length&&d.each(a.slideshows,function(a){A(a)}),a.iframes&&a.iframes.length&&d.each(a.iframes,function(a){B(a)})}),r.on("modal.create",function(a){z(a)}),r.on("card.rendered",function(a,b){s.on("viewable",a,d.bind(function(){this.send("card.view")},b))}),r.on("card.rendered",function(a,b){if(!u.shared)return!1;if(!b.query||!b.query.url)return!1;var e=d.hash(b.query.url);return e!==u.shared?!1:(u.shared=null,void setTimeout(function(){var a=f.rect(b.elem);return a&&a.top?void c.animateScroll(a.top-5,500):!1},500))});var G=function(a,b){r.on(a,b)},H=function(a,b){r.off(a,b)},I=function(){f.detachEvent(window,"message",w),j.stop(),r.clear(),f.remove(f.one("#emb_xcomm")),window.embedly=null},J=function(){var a=Array.prototype.slice.call(arguments,0);if(0===a.length)return null;var b=a.splice(0,1)[0];switch(b){case"card":return x.apply(window,a);case"button":return y.apply(window,a);case"modal":return z.apply(window,a);case"slideshow":return A.apply(window,a);case"look":return j.look.apply(window,a);case"on":return G.apply(window,a);case"off":return H.apply(window,a);case"kill":return I.apply(window,a);case"analytics":return C.apply(window,a);case"player":return F.apply(window,a);case"recommend":return D.apply(window,a);case"defaults":return E.apply(window,a)}return null},K=function(){var a=[];window.embedly&&d.isFunction(window.embedly)&&d.isArray(window.embedly.q)&&(a=window.embedly.q),window.embedly=function(){return J.apply(window,arguments)},window.embedly.card=function(){return x.apply(window,arguments)},window.embedly.button=function(){return y.apply(window,arguments)},window.embedly.modal=function(){return z.apply(window,arguments)},window.embedly.slideshow=function(){return A.apply(window,arguments)},window.embedly.look=function(){return j.look()},window.embedly.defaults=function(){return E.apply(window,arguments)},d.each(a,function(a){window.embedly.apply(window,a)}),i.connect(r),j.connect(r),g.bind(j.look),d.isFunction(window.onEmbedlyReady)&&window.onEmbedlyReady.apply(this,[window.embedly])};p.allowed(window.location.toString())?K():(window.embedly=function(){},d.each(["card","button","modal","slideshow","look","defaults"],function(a){window.embedly[a]=function(){}}))},{"./common/a.js":1,"./common/blacklist.js":3,"./common/browser.js":4,"./common/dom.js":7,"./common/found.js":8,"./common/iframes/all.js":9,"./common/integrate.js":16,"./common/libring.js":18,"./common/log/front.js":19,"./common/page.js":21,"./common/players.js":22,"./common/ready.js":23,"./common/recommend/front.js":24,"./common/share.js":25,"./common/utils.js":29,"./common/viewport.js":30}],conf:[function(a,b){!function(a){a.EMB_DEBUG=!1,a.EMB_HTTPS=!0,a.EMB_ORIGIN=(a.EMB_HTTPS?"https":"http")+"://cdn.embedly.com",a.EMB_ORIGIN_BASE=a.EMB_ORIGIN+"/",a.EMB_ASSET_VERSION="a7f17f16",a.EMB_FRAME_SRC=a.EMB_ORIGIN+"/widgets/",a.EMB_SECURE_FRAME_SRC="https://cdn.embedly.com/widgets/",a.EMB_POST_MESSAGE=!!window.postMessage,a.EMB_PROGRESS=!0,a.EMB_APP_API="https://app.embed.ly",a.EMB_API_KEY="fd92ebbc52fc43fb98f69e50e7893c13";var b=window.location.pathname.split(".")[0].split("/");a.EMB_GROUP=b[b.length-1].toLowerCase(),a.PAGE_PROGRESS_DOMAINS=[]}("undefined"==typeof b?this.conf={}:b.exports)},{}]},{},[31])}();